---
title: "API Gateway configuration"
linkTitle: "API Gateway"
weight: 1
date: 2021-09-02
---

Axway Open Banking API Gateway is based on the Axway API Gateway product.

Most features are documented in the [Axway API Gateway documentation](https://docs.axway.com/bundle/axway-open-docs/page/docs/apim_administration/apigtw_admin/index.html).

## Solution homepage

The solution homepage is available on `https://services-api.<domain-name>/open-banking/`.
![Solution Homepage](/Images/homepage.png).

The solution homepage is a static html page using CSS and a logo image that is easy to customize.

You can change titles and add or update links by modifying the index.html that is defined in `open-banking-apim/configmaps/apimgr-homepage-index`.

You can further customize the homepage by modifying the files in the `/opt/Axway/apigateway/openbanking/homepage` folder of the apimngr pod.

## Key Properties Store (KPS) configuration

The Key Properties Store of API Gateway is used to store the solution configuration variables.
This configuration can be read at the beginning of any policy using a common policy "Read Configuration."

| Column Name | Type | Purpose |
| --- | --- | --- |
| a_id | java.lang.String | Autogenerated Id. |
| b_tenantId | java.lang.String | Bank Identifier (helpful in multi tenant setup). |
| c_name | java.lang.String | API Name. |
| d_version | java.lang.String | API Version. |
| e_method | java.lang.String | API Method. |
| f_extension_1 | java.lang.String | For future use (example: HTTP Method). |
| g_extension_2 | java.lang.String | For future use. |
| k_values | java.util.Map`<java.lang.String,java.lang.String>` | Key Value Pairs, helps in extending configuration whenever we want without deployment. New key value pairs can be added easily.|

By default, only one line exists with no criteria (columns b to e) and values (column k) corresponding to solution deployment parameters. Refer to [Solution Deployment](/docs/deployment/installation) to see how to change these values during deployment.

You can check and update your current configuration from API Gateway Manager - Settings - Key Property Stores.

![kps-configuration](/Images/api-gateway-manager-kps-configuration.png)

Click on configuration and the line to be checked or updated.

![kps-values](/Images/api-gateway-manager-kps-values.png)

Several values should correspond to the settings of CLOUDENTITY ACP or its consent module. See the mapping table to check that the KPS values are correct.

| KPS Values | How to retrieve check this values in cloudentity ACP UI |
| --- | --- |
| oauth_consent_clientId | Custom IDP Demo bank login ID: bank customer. |
| oauth_consent_clientSecret | Custom IDP Demo bank login secret: bank customer. |
| oauth_consent_confirmation_clientid | Settings: consent screen client id. |
| oauth_consent_confirmation_clientSecret | Settings: consent screen client secret. |
| oauth_consent_user_clientSecret | Custom IDP Demo bank login secret: open banking workspace. |
| oauth_host | Host of acp server. |
| oauth_id | Openbanking workspace id in ACP server. |
| oauth_introspect_clientid | App is bank in openbanking workspace. |
| oauth_tenantid | Tenant id in ACP server. |

## API policies

API Gateway is configured with several API policies that are used with Open Banking flows.
You may want to customize some of these policies.

You can check the following policy definitions by opening Policy Studio and navigating to Policy - #AMPLIFY-OB.

![apim-policy-studio-apis](/Images/apim-policy-studio-api-containers.png)

If you decide to change one of them, you can use Policy Studio directly for the development environment only.
For other environments, you need to export the Policy Studio projects and build new APIM Docker images to use instead of the standard ones.

## Certificates

API Gateway is configured with several certificates that are used during the runtime:

* Server certificate
* Client certificate authority
* Jwt certificate
* Keys

You can check which ones are in use by opening Policy Studio and navigating to Environment Configuration - Certificate and Keys - Certificates.
Right-click a certificate to see if there are any references to it, meaning that they are currently in use.

![apim-policy-studio-certificates](/Images/apim-policy-studio-certificates.png)

If you identify the need to change one of them, refer to the API Gateway instructions that you can find under each section of [Certificate Management](/docs/configuration/certificate-management).
